{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport iziToast from 'izitoast';\nimport axios from 'axios';\n\nconst form = document.querySelector('.feedback-form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.wrap-loader');\nconst loadMoreBtn = document.querySelector('.button-load-more');\nconst loaderMore = document.querySelector('.wrap-loader-more');\nconst searchBtn = document.querySelector('.form-button');\n\nlet searchBar = '';\nlet maxPage = 0;\n\n// axios.defaults.baseURL = 'https://pixabay.com/';\n\nlet page = 1;\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nform.addEventListener('submit', onSearch);\n\nasync function fetchImages(searchBar, page = 1) {\n  const response = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: '42046594-dc9dc59be7e95573d854c379a',\n      q: `${searchBar}`,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page,\n      per_page: 15,\n    },\n  });\n  return response.data;\n}\n\nasync function onSearch(e) {\n  e.preventDefault();\n  gallery.innerHTML = '';\n  page = 1;\n  searchBtn.disabled = true;\n\n  const form = e.currentTarget;\n  searchBar = form.elements.search.value.trim();\n  if (searchBar === '') {\n    searchBtn.disabled = false;\n    return iziToast.show({\n      message: 'Please add value!',\n      messageColor: '#FAFAFB',\n      messageSize: '16px',\n      backgroundColor: '#EF4040',\n      position: 'topRight',\n    });\n  }\n\n  try {\n    const { hits, totalHits } = await fetchImages(searchBar);\n    loader.classList.remove('is-hidden');\n    maxPage = Math.ceil(totalHits / 15);\n\n    if (hits.length === 0) {\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        messageColor: '#FAFAFB',\n        messageSize: '16px',\n        backgroundColor: '#EF4040',\n        position: 'topRight',\n      });\n    } else {\n      createGallery(hits);\n      lightbox.refresh();\n\n      loadMoreBtn.classList.remove('is-hidden');\n      loadMoreBtn.addEventListener('click', handleLoadeMore);\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loader.classList.add('is-hidden');\n\n    form.reset;\n    searchBtn.disabled = false;\n  }\n}\n\nasync function handleLoadeMore(e) {\n  page += 1;\n  loaderMore.classList.remove('is-hidden');\n  loadMoreBtn.classList.add('is-hidden');\n\n  try {\n    const { hits } = await fetchImages(searchBar, page);\n\n    createGallery(hits);\n    lightbox.refresh();\n\n    const { height } = gallery.firstElementChild.getBoundingClientRect();\n    window.scrollBy(0, height * 2);\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loaderMore.classList.add('is-hidden');\n    loadMoreBtn.classList.remove('is-hidden');\n    if (maxPage === page) {\n      loadMoreBtn.classList.add('is-hidden');\n      loadMoreBtn.removeEventListener('click', handleLoadeMore);\n    }\n  }\n}\n\nfunction createGallery(hits) {\n  const marcup = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n           <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n          />\n\n            <ul class = \"description-list\">\n\n              <li class = \"description-item\">\n               <h3 class = \"description-title\">Likes</h3>\n               <p class = \"description-text\">${likes}</p>\n              </li>\n\n              <li class = \"description-item\">\n               <h3 class = \"description-title\">Views</h3>\n               <p class = \"description-text\">${views}</p>\n              </li>\n          \n              <li class = \"description-item\">\n               <h3 class = \"description-title\">Comments</h3>\n               <p class = \"description-text\">${comments}</p>\n              </li>\n\n              <li class = \"description-item\">\n               <h3 class = \"description-title\">Downloads</h3>\n               <p class = \"description-text\">${downloads}</p>\n               </li>\n          \n             </ul>\n           </a>\n\n      </li>\n      `\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', marcup);\n}\n"],"names":["form","gallery","loader","loadMoreBtn","loaderMore","searchBtn","searchBar","maxPage","page","lightbox","SimpleLightbox","onSearch","fetchImages","axios","e","iziToast","hits","totalHits","createGallery","handleLoadeMore","error","height","marcup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}